<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>RULETA SAN MIGUEL</title>

  <style>
    :root{
      --red:#e10600;
      --red2:#b70000;
      --yellow:#ffd200;
      --white:#ffffff;
      --ink:#111111;
      --shadow: 0 18px 45px rgba(0,0,0,.35);
      --cardShadow: 0 22px 60px rgba(0,0,0,.35);
    }

    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      display:flex;
      justify-content:center;
      align-items:center;
      background: radial-gradient(circle at 50% 12%, #ffeaa3 0%, #ffd14a 35%, #f7b600 70%, #d18200 100%);
      overflow:hidden;
      color: var(--ink);
    }

    /* brillo/viñeta (sin confeti fijo) */
    body::before{
      content:"";
      position:fixed; inset:0;
      background:
        radial-gradient(circle at 50% 12%, rgba(255,255,255,.25), transparent 55%),
        radial-gradient(circle at 20% 35%, rgba(255,255,255,.14), transparent 45%),
        radial-gradient(circle at 80% 25%, rgba(255,255,255,.14), transparent 50%),
        radial-gradient(circle at 50% 0%, rgba(255,255,255,.18), transparent 60%);
      opacity:.55;
      pointer-events:none;
      filter: blur(.3px);
    }
    body::after{
      content:"";
      position:fixed; inset:-40px;
      background:
        radial-gradient(circle at 15% 40%, rgba(0,0,0,.22), transparent 38%),
        radial-gradient(circle at 85% 35%, rgba(0,0,0,.20), transparent 42%),
        radial-gradient(circle at 50% 95%, rgba(0,0,0,.25), transparent 45%);
      pointer-events:none;
      mix-blend-mode:multiply;
      opacity:.35;
    }

    /* ✅ Responsive phone canvas */
    .screen{
      width: min(430px, 100vw);
      height: 100vh;
      max-height: 100svh;
      padding: clamp(12px, 2.6vh, 18px) clamp(12px, 3vw, 16px);
      display:flex;
      flex-direction:column;
      gap: clamp(10px, 1.8vh, 14px);
      position:relative;
    }

    /* logo */
    .topLogo{
      display:flex;
      flex-direction:column;
      align-items:center;
      text-align:center;
    }
    .topLogo img{
      width: clamp(85px, 18vw, 120px);
      height:auto;
      display:block;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.25));
    }

    /* cartel */
    .board{
      background: var(--white);
      border-radius: 18px;
      padding: clamp(12px, 2.2vh, 16px) 14px;
      box-shadow: var(--cardShadow);
      position:relative;
      overflow:hidden;
      border: 2px solid rgba(255,210,0,.55);
    }
    .board::before{
      content:"";
      position:absolute; inset: 8px;
      border-radius: 14px;
      border: 2px solid rgba(255,210,0,.65);
      pointer-events:none;
    }
    .board h1{
      margin: 2px 0 0;
      font-size: clamp(34px, 6.2vw, 44px);
      line-height: 1;
      letter-spacing: .5px;
      font-weight: 1000;
      color: var(--red);
      text-align:center;
    }
    .board .tagWrap{ text-align:center; }
    .board .tag{
      margin: 6px auto 10px;
      display:inline-block;
      background: var(--yellow);
      color: var(--red2);
      padding: 8px 14px;
      border-radius: 8px;
      font-weight: 1000;
      font-size: clamp(20px, 4.5vw, 26px);
      letter-spacing:.4px;
      transform: skewX(-6deg);
      box-shadow: 0 10px 18px rgba(0,0,0,.12);
    }
    .board .sub{
      margin: 2px 0 0;
      text-align:center;
      font-size: clamp(14px, 3.6vw, 18px);
      font-weight: 900;
      color: #d10a00;
    }

    /* rueda */
    .wheelArea{
      flex: 1;
      min-height: 0; /* important for flex scaling */
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap: 10px;
      position:relative;
      padding-top: 2px;
    }

    .pointer{
      width:0;height:0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 36px solid var(--yellow);
      filter: drop-shadow(0 12px 20px rgba(0,0,0,.35));
      position:relative;
      margin-bottom: -10px;
      z-index:5;
    }
    .pointer::after{
      content:"";
      position:absolute;
      left:-16px; top:8px;
      width:0; height:0;
      border-left:16px solid transparent;
      border-right:16px solid transparent;
      border-bottom: 28px solid var(--red);
      transform: translateY(-2px) scale(.86);
      opacity:.9;
    }

    .wheelWrap{
      width: min(92vw, 360px);
      aspect-ratio: 1/1;
      position:relative;
      filter: drop-shadow(0 22px 40px rgba(0,0,0,.28));
    }
    @media (max-height: 740px){
      .wheelWrap{ width: min(88vw, 320px); }
    }
    @media (max-height: 680px){
      .wheelWrap{ width: min(84vw, 290px); }
    }

    .ring{
      position:absolute; inset:0;
      border-radius:50%;
      background:
        radial-gradient(circle at 50% 50%, rgba(255,255,255,0) 56%, rgba(0,0,0,.12) 57%, rgba(0,0,0,.0) 63%),
        radial-gradient(circle at 50% 50%, rgba(255,210,0,.0) 63%, rgba(255,210,0,.85) 64%, rgba(255,210,0,.85) 69%, rgba(0,0,0,.0) 70%),
        radial-gradient(circle at 50% 50%, rgba(255,255,255,.95) 0 55%, rgba(255,255,255,0) 56%);
      box-shadow: inset 0 0 0 10px rgba(255,210,0,.45);
    }
    .bulbs{
      position:absolute; inset: 10px;
      border-radius:50%;
      pointer-events:none;
      background:
        repeating-conic-gradient(from 0deg,
          rgba(255,255,255,.90) 0 6deg,
          rgba(255,255,255,0) 6deg 18deg
        );
      mix-blend-mode: soft-light;
      opacity:.65;
      filter: blur(.2px);
    }
    canvas{
      position:absolute; inset: 18px;
      width: calc(100% - 36px);
      height: calc(100% - 36px);
      border-radius: 50%;
      background: transparent;
    }

    /* ✅ Centro clickeable: el ÚNICO botón para girar */
    .centerButton{
      position:absolute;
      left:50%; top:50%;
      transform: translate(-50%,-50%);
      width: clamp(120px, 32vw, 150px);
      height: clamp(120px, 32vw, 150px);
      border-radius:50%;
      background: radial-gradient(circle at 35% 30%, #ffffff 0%, #fff1c6 35%, #ffe06b 62%, #ffcf2b 85%);
      box-shadow: 0 14px 28px rgba(0,0,0,.22), inset 0 0 0 10px rgba(255,210,0,.85);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      z-index: 10;
      border: 0;
      cursor: pointer;
      user-select:none;
    }
    .centerButton:active{ transform: translate(-50%,-50%) scale(.99); }
    .centerButton:disabled{ opacity:.65; cursor:not-allowed; }

    .centerButton .small{
      font-weight: 1000;
      font-size: 14px;
      color: rgba(0,0,0,.65);
      letter-spacing:.2px;
      margin-bottom: 2px;
    }
    .centerButton .big{
      font-weight: 1000;
      font-size: 34px;
      color: var(--red);
      letter-spacing:.6px;
      line-height:1;
      text-shadow: 0 2px 0 rgba(255,255,255,.55);
    }

    /* overlay ganador */
    .overlay{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      background: rgba(0,0,0,.45);
      backdrop-filter: blur(2px);
      z-index: 50;
    }
    .overlay.show{ display:flex; }

    .winCard{
      width: min(430px, 96vw);
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.96), rgba(255,255,255,.92));
      border: 2px solid rgba(255,210,0,.75);
      box-shadow: 0 30px 70px rgba(0,0,0,.35);
      padding: 16px 14px 14px;
      text-align:center;
      position:relative;
      overflow:hidden;
    }
    .winCard::before{
      content:"";
      position:absolute; inset:-20px;
      background:
        radial-gradient(circle at 20% 10%, rgba(255,210,0,.55), transparent 40%),
        radial-gradient(circle at 80% 0%, rgba(225,6,0,.35), transparent 45%);
      opacity:.55;
      pointer-events:none;
    }
    .winTitle{
      position:relative;
      margin: 8px 0 6px;
      font-size: 42px;
      color: var(--yellow);
      font-weight: 1000;
      text-shadow: 0 4px 0 rgba(225,6,0,.90);
      letter-spacing:.3px;
    }
    .prizePill{
      position:relative;
      margin: 10px auto 14px;
      display:inline-block;
      padding: 12px 16px;
      border-radius: 16px;
      background: linear-gradient(180deg, var(--red) 0%, #b40000 100%);
      color: var(--white);
      font-weight: 1000;
      font-size: 22px;
      border: 3px solid rgba(255,210,0,.9);
      box-shadow: 0 18px 35px rgba(0,0,0,.22);
      max-width: 92%;
      word-break: break-word;
    }
    .winBtns{
      position:relative;
      display:flex;
      gap: 12px;
      margin-top: 10px;
    }
    .winBtns button{
      flex:1;
      border:0;
      border-radius: 14px;
      padding: 12px 12px;
      font-weight: 1000;
      font-size: 18px;
      cursor:pointer;
      box-shadow: 0 14px 24px rgba(0,0,0,.18);
    }
    .backBtn{
      background: linear-gradient(180deg, var(--red) 0%, #b40000 100%);
      color: var(--yellow);
      border: 2px solid rgba(255,210,0,.85);
    }
    .exitBtn{
      background: linear-gradient(180deg, #ffffff 0%, #f2f2f2 100%);
      color: var(--red);
      border: 2px solid rgba(255,210,0,.85);
    }

    /* Confeti SOLO al ganar */
    .confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index: 999;
    }
    .confetti span{
      position:absolute;
      width:10px;
      height:16px;
      top:-24px;
      border-radius:2px;
      animation: fall 1.8s linear forwards;
      opacity: 1;
    }
    @keyframes fall{
      to{
        transform: translateY(110vh) rotate(420deg);
        opacity:0;
      }
    }

    /* pequeño footer invisibilizado (espacio) */
    .spacer{ height: 2px; }
  </style>
</head>

<body>
  <div class="screen">

    <div class="topLogo">
      <img src="logo.png" alt="San Miguel SRL">
    </div>

    <div class="board">
      <h1>RULETA</h1>
      <div class="tagWrap">
        <div class="tag">SAN MIGUEL</div>
      </div>
      <div class="sub">¡Con tu carga de +35L de V-POWER girá y descubrí tu premio!</div>
    </div>

    <div class="wheelArea">
      <div class="pointer" aria-hidden="true"></div>

      <div class="wheelWrap">
        <div class="ring"></div>
        <div class="bulbs"></div>
        <canvas id="wheel" width="700" height="700"></canvas>

        <!-- ✅ ÚNICO control: botón del medio -->
        <button id="centerSpin" class="centerButton" type="button" aria-label="Girar ruleta">
        
          <div class="big">GIRAR</div>
        </button>
      </div>
    </div>

    <div class="spacer"></div>
  </div>

  <!-- Confeti -->
  <div id="confettiBox" class="confetti"></div>

  <!-- Overlay ganador -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true">
    <div class="winCard">
      <div class="winTitle">¡Ganaste!</div>
      <div id="winPrize" class="prizePill">—</div>
      <div class="winBtns">
        <button id="backBtn" class="backBtn" type="button">VOLVER</button>
        <button id="exitBtn" class="exitBtn" type="button">SALIR</button>
      </div>
    </div>
  </div>

  <script>
    // =========================================
    // ✅ LISTA DE PREMIOS (EDITÁS ACÁ)
    // =========================================
    // Tip: si repetís un premio, sale más seguido.
    let prizes = [
    
      "AGUA/ AGUA SABORIZADA 1L",
      "COCA COLA 1L",
      "2x1 HELADOS COFLER",
      "1 HELADO MOGUL",
      "1 HELADO MOGUL",
      "1 HELADO MOGUL",
      "1 HELADO MOGUL",
      "1 HELADO MOGUL",
      "1 HELADO MOGUL",
      "1 HELADO MOGUL",
      "1 HELADO MOGUL",
      "1 HELADO MOGUL"
      
    ];

    const canvas = document.getElementById("wheel");
    const ctx = canvas.getContext("2d");

    const centerSpin = document.getElementById("centerSpin");

    const overlay = document.getElementById("overlay");
    const winPrize = document.getElementById("winPrize");
    const backBtn = document.getElementById("backBtn");
    const exitBtn = document.getElementById("exitBtn");

    const confettiBox = document.getElementById("confettiBox");

    let rotation = 0;
    let spinning = false;

    function segmentColor(i){
      // rojo / amarillo / blanco
      const mod = i % 3;
      if(mod === 0) return "#e10600";
      if(mod === 1) return "#ffd200";
      return "#ffffff";
    }
    function textColorFor(bg){
      if(bg === "#ffffff") return "#e10600";
      if(bg === "#ffd200") return "#b70000";
      return "#ffffff";
    }

    function drawWheel(){
      const size = canvas.width;
      const r = size/2;

      ctx.clearRect(0,0,size,size);

      if(prizes.length < 2){
        ctx.fillStyle = "#111";
        ctx.font = "900 30px system-ui";
        ctx.textAlign = "center";
        ctx.fillText("Cargá premios", r, r);
        return;
      }

      const slice = (Math.PI * 2) / prizes.length;

      ctx.save();
      ctx.translate(r,r);
      ctx.rotate(rotation);

      for(let i=0;i<prizes.length;i++){
        const start = i*slice;
        const end = start + slice;

        ctx.beginPath();
        ctx.moveTo(0,0);
        ctx.arc(0,0,r-10,start,end);
        ctx.closePath();

        const bg = segmentColor(i);
        ctx.fillStyle = bg;
        ctx.fill();

        ctx.strokeStyle = "rgba(0,0,0,.12)";
        ctx.lineWidth = 4;
        ctx.stroke();

        ctx.save();
        ctx.rotate(start + slice/2);
        ctx.textAlign = "right";
        ctx.fillStyle = textColorFor(bg);
        ctx.font = "1000 22px system-ui";

        const label = prizes[i].length > 20 ? prizes[i].slice(0,20) + "…" : prizes[i];
        ctx.fillText(label, r-28, 8);
        ctx.restore();
      }

      ctx.restore();

      ctx.beginPath();
      ctx.arc(r, r, r-18, 0, Math.PI*2);
      ctx.strokeStyle = "rgba(255,210,0,.55)";
      ctx.lineWidth = 8;
      ctx.stroke();
    }

    function pickIndex(){
      return Math.floor(Math.random() * prizes.length);
    }
    function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }

    function spin(){
      if(spinning) return;
      if(prizes.length < 2){
        alert("Cargá al menos 2 premios en el código (lista prizes).");
        return;
      }

      spinning = true;
      centerSpin.disabled = true;

      const duration = 4200;
      const start = performance.now();

      const index = pickIndex();
      const slice = (Math.PI*2)/prizes.length;

      const target =
        (Math.PI*2) * 6 +
        (Math.PI*2) -
        (index*slice + slice/2);

      const startRot = rotation;
      const delta = target - (startRot % (Math.PI*2));

      function frame(now){
        const t = Math.min(1, (now - start) / duration);
        rotation = startRot + delta * easeOutCubic(t);
        drawWheel();

        if(t < 1){
          requestAnimationFrame(frame);
        } else {
          spinning = false;
          centerSpin.disabled = false;

          const prize = prizes[index];
          showWinner(prize);
        }
      }

      requestAnimationFrame(frame);
    }

    function showWinner(prize){
      winPrize.textContent = prize;
      overlay.classList.add("show");
      launchConfetti(); // ✅ solo acá
    }
    function closeWinner(){
      overlay.classList.remove("show");
    }

    function launchConfetti(){
      confettiBox.innerHTML = "";
      const colors = ["#e10600","#ffd200","#ffffff"];

      for(let i=0;i<55;i++){
        const c = document.createElement("span");
        c.style.left = (Math.random()*100) + "%";
        c.style.background = colors[Math.floor(Math.random()*colors.length)];
        c.style.animationDuration = (1.1 + Math.random()*1.4) + "s";
        c.style.transform = "rotate(" + (Math.random()*360) + "deg)";
        c.style.opacity = String(0.85 + Math.random()*0.15);
        c.style.width = (8 + Math.random()*8) + "px";
        c.style.height = (10 + Math.random()*12) + "px";
        confettiBox.appendChild(c);
      }

      setTimeout(()=>{ confettiBox.innerHTML = ""; }, 2100);
    }

    // ✅ eventos
    centerSpin.addEventListener("click", spin);

    // por si tocás el overlay afuera, cierra
    overlay.addEventListener("click", (e) => {
      if(e.target === overlay) closeWinner();
    });
    backBtn.addEventListener("click", closeWinner);
    exitBtn.addEventListener("click", closeWinner);

    // init
    drawWheel();
  </script>
</body>
</html>
